<!DOCTYPE html>
<html>
<head>
    <title>Product List</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            // Add Product - XHR
            $('#add-product-form').submit(function(event) {
 event.preventDefault();
                var form = $(this);
 $.ajax({
                    url: form.attr('action'),
                    type: form.attr('method'),
                    data: form.serialize(),
                    success: function(response) {
                        // Handle success response
                        console.log(response);
                        // Refresh the product list
                        loadProductList();
                    },
                    error: function(xhr, errmsg, err) {
                        // Handle error response
                        console.log(xhr.status + ": " + xhr.responseText);
                    }
                });
            });

            // Update Product - XHR
            $('.update-product-form').submit(function(event) {
 event.preventDefault();
                var form = $(this);
 $.ajax({
                    url: form.attr('action'),
                    type: form.attr('method'),
                    data: form.serialize(),
                    success: function(response) {
                        // Handle success response
                        console.log(response);
                        // Refresh the product list
                        loadProductList();
                    },
                    error: function(xhr, errmsg, err) {
                        // Handle error response
                        console.log(xhr.status + ": " + xhr.responseText);
                    }
                });
            });

            // Delete Product - XHR
            $('.delete-product-form').submit(function(event) {
 event.preventDefault();
                var form = $(this);
 $.ajax({
                    url: form.attr('action'),
                    type: form.attr('method'),
                    data: form.serialize(),
                    success: function(response) {
                        // Handle success response
                        console.log(response);
                        // Refresh the product list
                        loadProductList();
                    },
                    error: function(xhr, errmsg, err) {
                        // Handle error response
                        console.log(xhr.status + ": " + xhr.responseText);
                    }
                });
            });

            // Load Product List - XHR
            function loadProductList() {
 $.ajax({
                    url: '/products/',  // Replace with your actual URL for fetching the product list
                    type: 'GET',
                    success: function(response) {
                        // Handle success response
                        $('#product-list').html(response);
                    },
                    error: function(xhr, errmsg, err) {
                        // Handle error response
                        console.log(xhr.status + ": " + xhr.responseText);
                    }
                });
            }

            // Initial load of the product list
            loadProductList();
        });
    </script>

<head>
    <title>Product Detail</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/modal.css' %}">

</head>
<body>
    <h1>{{ product.name }}</h1>
    <p>Price: ${{ product.price }}</p>

    <!-- Button to open the modal -->
    <button id="updateBtn">Update Product</button>

    <!-- The Modal -->
    <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <span class="close">&times;</span>
            <form id="updateForm" method="POST" action="{% url 'product_detail' product.pk %}">
 {% csrf_token %}
                {{ form.as_p }}
 <input type="submit" value="Update">
            </form>
        </div>
    </div>

    <script src="{% static 'js/modal.js' %}"></script>
</body>


</head>
<body>
    <h1>Product List</h1>

    <!-- Add Product Form -->
    {% load static %}
    <form id="add-product-form" method="POST" action="{% url 'add_product' %}">
        {% csrf_token %}
        <!-- Add your form fields here -->
        <button type="submit">Add Product</button>
    </form>

    <!-- Product List -->
    <table>
        <thead>
            <tr>
 <th>Name</th>
                <th>Quantity</th>
 <th>Price</th>
 <th>Actions</th>
            </tr>
        </thead>
        <tbody id="product-list">
            <!-- Product list will be dynamically loaded here -->
        </tbody>
    </table>

    <!-- Update Product Form (Hidden) -->
    <form class="update-product-form" method="POST" style="display: none;">
        {% csrf_token %}
        <input type="hidden" name="id" value="">
        <input type="text" name="name" value="">
        <input type="number" name="quantity" value="">
        <input type="number" name="price" step="0.01" value="">
        <button type="submit">Update</button>
    </form>

    <!-- Delete Product Form (Hidden) -->
    <form class="delete-product-form" method="POST" style="display: none;">
        {% csrf_token %}
        <input type="hidden" name="id" value="">
        <button type="submit">Delete</button>
    </form>
</body>
</html>
